# Authentication with Oauth 2.0 Plugin

## Make sure previous tutorial work
Please do `docker ps` to make sure all three container is running
```sh
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                                                                                            NAMES
6331440480d5        node_kong           "docker-entrypoint.s…"   41 hours ago        Up 41 hours         10000/tcp                                                                                        node_kong
d4495855da83        kong:latest         "/docker-entrypoint.…"   41 hours ago        Up 41 hours         0.0.0.0:9000->8000/tcp, 0.0.0.0:9001->8001/tcp, 0.0.0.0:9443->8443/tcp, 0.0.0.0:9444->8444/tcp   kong
e12e70d1f830        postgres:9.6        "docker-entrypoint.s…"   42 hours ago        Up 42 hours         0.0.0.0:5555->5432/tcp                                                                           kong-database
```
And could hit API service throught Kong with:

**GET: localhost:9000/api/v1/customers**

With curl `curl -i -X GET localhost:9000/api/v1/customers`

Response:
```sh
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
Content-Length: 110
Connection: keep-alive
X-Powered-By: Express
ETag: W/"6e-Tf3vAGLC3XH0dFR2pCIzWdG8/5c"
Date: Mon, 30 Mar 2020 06:48:07 GMT
X-Kong-Upstream-Latency: 2
X-Kong-Proxy-Latency: 2
Via: kong/2.0.2

[{"id":5,"first_name":"Dodol","last_name":"Dargombez"},{"id":6,"first_name":"Nyongot","last_name":"Gonzales"}]
```

KONG as API gateway connected to upstream service as own API/service to get customers

Dont forget to download postman collection on previous tutorial, we will explore folder:
  - Plugin
  - Consumer
  - Application
  - OAuthToken

## Enabling the plugin on a service
Previously we already have a service `api-v1-customers`.

To make sure, lets check it

**GET: localhost:9001/services/**

With curl
```sh
curl -X GET localhost:9001/services | jq .
```
ps: jq will structure output to json format. On macOS you can install it using homebrew with command `brew install jq`

```sh
{
  "next": null,
  "data": [
    {
      "host": "192.168.192.4",
      "created_at": 1585491636,
      "connect_timeout": 60000,
      "id": "7da29f51-4a2a-49ba-b3ab-696ef2c87246",
      "protocol": "http",
      "name": "api-v1-customers",
      "read_timeout": 60000,
      "port": 10000,
      "path": "/api/v1/customers",
      "updated_at": 1585491636,
      "retries": 5,
      "write_timeout": 60000,
      "tags": null,
      "client_certificate": null
    }
  ]
}
```
